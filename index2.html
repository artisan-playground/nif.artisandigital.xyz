<html>

<head>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
  <script src="libs/p5.play.js"></script>

  <script>
    //animations like p5 images should be stored in variables
    //in order to be displayed during the draw cycle
    var nfirst;
    var mouse_moved = false;
    var touch_started = false;

    var player_frames = [
      { 'name': 'player_walk01', 'frame': { 'x': 0, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk02', 'frame': { 'x': 71, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk03', 'frame': { 'x': 142, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk04', 'frame': { 'x': 0, 'y': 95, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk05', 'frame': { 'x': 71, 'y': 95, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk06', 'frame': { 'x': 142, 'y': 95, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk07', 'frame': { 'x': 213, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk08', 'frame': { 'x': 284, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk09', 'frame': { 'x': 213, 'y': 95, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk10', 'frame': { 'x': 355, 'y': 0, 'width': 70, 'height': 94 } },
      { 'name': 'player_walk11', 'frame': { 'x': 284, 'y': 95, 'width': 70, 'height': 94 } }
    ];
    //it's advisable (but not necessary) to load the images in the preload function
    //of your sketch otherwise they may appear with a little delay
    function preload() {
      //create an animation from a sequence of numbered images
      //pass the first and the last file name and it will try to find the ones in between]
      nfirst = loadSpriteSheet('assets/first_001.png', player_frames);
      player_stand = loadAnimation(new SpriteSheet('assets/first_001.png',
        [{ 'name': 'player_stand', 'frame': { 'x': 0, 'y': 0 } }]));
    }

    function setup() {
      createCanvas(800, 600);

      // Create the Player sprite and add it's animations
      nfirst = createSprite(100, 284, 70, 94);
      // player_sprite.addAnimation('walk', player_walk);
      nfirst.addAnimation('stand', player_stand);
    }

    function draw() {
      clear();
      background(0, 255, 255);

      var eventX;
      if (isTouch()) {
        eventX = touchX;
      } else {
        eventX = mouseX;
      }
      if (eventX < nfirst.position.x - 10) {
        // flip horizontally
        nfirst.mirrorX(-1);
        // move left
        nfirst.velocity.x = -2;
      }
      else if (eventX > nfirst.position.x + 10) {
        // flip horizontally
        nfirst.mirrorX(1);
        // move right
        nfirst.velocity.x = 2;
      }
      else {
        //if close to the mouse, don't move
        nfirst.velocity.x = 0;
      }
      drawSprites();
    }
    function touchStarted() {
      touch_started = true;
    }

    function mouseMoved() {
      mouse_moved = true;
    }

    function isTouch() {
      return touch_started && !mouse_moved;
    }

  </script>
</head>

<body>
  <main></main>
</body>

</html>